{% load static %}
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Google Font Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
    <link rel="stylesheet" href="{% static 'styles.css' %}"/>
    <title>Jom Mail | Templates</title>
    <link rel="stylesheet" href="{% static 'style.css' %}">
    <link rel="stylesheet" href="{% static 'compose.css' %}">

    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <script defer src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  </head>
  <body>
    <!-- Header Starts -->
    <div class="header">
      <div class="header__left">
        <span class="material-icons"> menu </span>
       <h2>Jom Mail</h2>
      </div>

      <div class="header__middle">
        <span class="material-icons"> search </span>
        <input type="text" placeholder="Search mail" />
        <span class="material-icons"> arrow_drop_down </span>
      </div>

      <div class="header__right">
       
        <span class="material-icons" style="font-size:40px;" onclick="window.location.href='/accounts/profile'"> account_circle </span>
      </div>
    </div>
    <!-- Header Ends -->

    <!-- Main Body Starts -->
    <div class="main__body">
      <!-- Sidebar Starts -->
      <div class="sidebar">
        <button class="sidebar__compose" id="composeButton"><span class="material-icons"> add </span>Compose</button>
        <div class="sidebarOption sidebarOption__active">
          <span class="material-icons"> inbox </span>
          <h3>Dashboard</h3>
        </div>

        


        <div class="sidebarOption" onclick="window.location.href='/mail/sent'">
          <span class="material-icons"> near_me </span>
          <h3>Sent</h3>
        </div>

         <!-- <div class="sidebarOption" onclick="window.location.href='/mail/sent?type_=draft'">
          <span class="material-icons"> note </span>
          <h3>Drafts</h3>
        </div> -->

        <div class="sidebarOption" onclick="window.location.href='/contacts'">
            <span class="material-icons"> phone</span>
            <h3>Contacts</h3>
            
          </div>
          <div class="sidebarOption" onclick="window.location.href='/templates'">
            <span class="material-icons"> campaign</span>
            <h3>Templates</h3>
            
          </div>
          <div class="sidebarOption" onclick="window.location.href='/campaign'">
            <span class="material-icons"> campaign</span>
            <h3>Campaign</h3>
          </div>
          <div class="sidebarOption" onclick="window.location.href='/accounts/logout'">
            <span class="material-icons"> logout </span>
            <h3>Logout</h3>
          </div>

        
        
      </div>


      <style>
              
      .mrow{
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
      }

      .mcard{
        margin: 15px;
        width: 250px;
        height: 100px;
        padding: 10px;
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        justify-content: center;
        box-shadow: 2px 2px 4px 2px rgba(0, 0, 0, 0.2);
        
      }

      .mcard:hover{
        width: 270px;
        height: 120px;
        background-color: rgb(230, 222, 222);
      }
      </style>









      <!-- Sidebar Ends -->

      <!-- Email List Starts -->
      <div class="emailList">
        <div class="card p-3 m-3" style="border: 1px solid black;height: 550px;overflow-y: scroll;">
          <h4><b>Marketing Email Sample</b></h4><br>

          <hr>
          <pre><code id="emailMarketingCode">&lt;!DOCTYPE html&gt;
            &lt;html lang="en"&gt;
            &lt;head&gt;
            &lt;meta charset="UTF-8"&gt;
            &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
            &lt;title&gt;Email Marketing Email Template&lt;/title&gt;
            &lt;style&gt;
                /* Reset styles */
                body, html {
                    margin: 0;
                    padding: 0;
                    font-family: Arial, sans-serif;
                    font-size: 16px;
                    line-height: 1.6;
                }
                img {
                    max-width: 100%;
                    height: auto;
                }
            &lt;/style&gt;
            &lt;/head&gt;
            &lt;body&gt;
            
            &lt;table align="center" width="600" cellspacing="0" cellpadding="0" border="0"&gt;
                &lt;tr&gt;
                    &lt;td style="background-color: #f8f8f8; padding: 20px;"&gt;
                        &lt;h1 style="color: #333;"&gt;Check Out Our Latest Offer!&lt;/h1&gt;
                        &lt;p style="color: #666;"&gt;Dear valued customer, we're excited to offer you our latest promotion:&lt;/p&gt;
                        &lt;p style="color: #666;"&gt;50% off on selected items for a limited time only! Don't miss out!&lt;/p&gt;
                        &lt;p style="color: #666;"&gt;Visit our website to shop now: &lt;a href="https://example.com" style="color: #007bff;"&gt;example.com&lt;/a&gt;&lt;/p&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                    &lt;td style="background-color: #333; color: #fff; text-align: center; padding: 20px;"&gt;
                        &lt;p&gt;&amp;copy; 2024 Company Name. All rights reserved.&lt;/p&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
            &lt;/table&gt;
            
            &lt;/body&gt;
            &lt;/html&gt;
            </code></pre>
            
            <button class="btn btn-primary" onclick="copyEmailMarketingCode()">Copy Code</button>
            
            <script>
            function copyEmailMarketingCode() {
                var code = document.getElementById('emailMarketingCode').innerText;
                navigator.clipboard.writeText(code)
                    .then(() => {
                        alert('Code copied to clipboard!');
                    })
                    .catch(err => {
                        console.error('Failed to copy code: ', err);
                    });
            }
            </script>
            
          </div>

        <div class="card p-3 m-3" style="border: 1px solid black;height: 550px;overflow-y: scroll;">
          <h4><b>Welcome Email Sample</b></h4><br>

          <hr>

          <pre><code id="htmlCode">&lt;!DOCTYPE html&gt;
            &lt;html lang="en"&gt;
            &lt;head&gt;
            &lt;meta charset="UTF-8"&gt;
            &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
            &lt;title&gt;Email Template&lt;/title&gt;
            &lt;style&gt;
                /* Reset styles */
                body, html {
                    margin: 0;
                    padding: 0;
                    font-family: Arial, sans-serif;
                    font-size: 16px;
                    line-height: 1.6;
                }
                img {
                    max-width: 100%;
                    height: auto;
                }
            &lt;/style&gt;
            &lt;/head&gt;
            &lt;body&gt;
            
            &lt;table align="center" width="600" cellspacing="0" cellpadding="0" border="0"&gt;
                &lt;tr&gt;
                    &lt;td style="background-color: #f8f8f8; padding: 20px;"&gt;
                        &lt;h1 style="color: #333;"&gt;Welcome to Our Newsletter!&lt;/h1&gt;
                        &lt;p style="color: #666;"&gt;Thank you for subscribing to our newsletter. Here's what's new:&lt;/p&gt;
                        &lt;ul style="color: #666;"&gt;
                            &lt;li&gt;New product launches&lt;/li&gt;
                            &lt;li&gt;Exclusive offers&lt;/li&gt;
                            &lt;li&gt;Exciting updates&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;p style="color: #666;"&gt;Stay tuned for more updates!&lt;/p&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                    &lt;td style="background-color: #333; color: #fff; text-align: center; padding: 20px;"&gt;
                        &lt;p&gt;&amp;copy; 2024 Company Name. All rights reserved.&lt;/p&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
            &lt;/table&gt;
            
            &lt;/body&gt;
            &lt;/html&gt;
            </code></pre>
            
            <button onclick="copyCode()" class="btn btn-primary">Copy Code</button>

 
            <script>
            function copyCode() {
                var code = document.getElementById('htmlCode').innerText;
                navigator.clipboard.writeText(code)
                    .then(() => {
                        alert('Code copied to clipboard!');
                    })
                    .catch(err => {
                        console.error('Failed to copy code: ', err);
                    });
            }
            </script>
        </div>
      
            
        <br><br>



        <div class="card p-3 m-3" style="border: 1px solid black;height: 550px;overflow-y: scroll;">
          <h4><b>OTP Email Sample</b></h4><br>

          <hr>
        
<pre><code id="otpCode">&lt;!DOCTYPE html&gt;
  &lt;html lang="en"&gt;
  &lt;head&gt;
  &lt;meta charset="UTF-8"&gt;
  &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
  &lt;title&gt;OTP Email Template&lt;/title&gt;
  &lt;style&gt;
      /* Reset styles */
      body, html {
          margin: 0;
          padding: 0;
          font-family: Arial, sans-serif;
          font-size: 16px;
          line-height: 1.6;
      }
      img {
          max-width: 100%;
          height: auto;
      }
  &lt;/style&gt;
  &lt;/head&gt;
  &lt;body&gt;
  
  &lt;table align="center" width="600" cellspacing="0" cellpadding="0" border="0"&gt;
      &lt;tr&gt;
          &lt;td style="background-color: #f8f8f8; padding: 20px;"&gt;
              &lt;h1 style="color: #333;"&gt;Your OTP&lt;/h1&gt;
              &lt;p style="color: #666;"&gt;Your OTP is: &lt;b&gt;123456&lt;/b&gt;&lt;/p&gt;
              &lt;p style="color: #666;"&gt;Please use this OTP to complete your verification.&lt;/p&gt;
          &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style="background-color: #333; color: #fff; text-align: center; padding: 20px;"&gt;
              &lt;p&gt;&amp;copy; 2024 Company Name. All rights reserved.&lt;/p&gt;
          &lt;/td&gt;
      &lt;/tr&gt;
  &lt;/table&gt;
  
  &lt;/body&gt;
  &lt;/html&gt;
  </code></pre>
  
  <button onclick="copyOTPCode()" class="btn btn-primary">Copy Code</button>
  
  <script>
  function copyOTPCode() {
      var code = document.getElementById('otpCode').innerText;
      navigator.clipboard.writeText(code)
          .then(() => {
              alert('Code copied to clipboard!');
          })
          .catch(err => {
              console.error('Failed to copy code: ', err);
          });
  }
  </script>
        </div>
        <br><br>








        </div>

       
        <br><br>
        <!-- Settings Ends -->

       

        <!-- Email List rows starts -->
        <div class="emailList__list">
          <!-- Email Row Starts -->
          <!-- <div class="emailRow">
            <div class="emailRow__options">
              
              <span class="material-icons"> label_important </span>
            </div>

            <h3 class="emailRow__title">YouTube</h3>

            <div class="emailRow__message">
              <h6>
                You Got a New Subscriber
                <span class="emailRow__description"> - on Your Channel Future Coders </span>
              </h6>
            </div>

            <p class="emailRow__time">{{email.created_at}}</p>
          </div> -->
          <!-- Email Row Ends -->


          <script>
            function formatText(text) {
                // Replace *hello* with <b>hello</b>
                text = text.replace(/\*(.*?)\*/g, "<b>$1</b>");
                
                // Replace [hello](link) with <a href="link">hello</a>
                console.log(text);
                return text;
            }


            function rewriteAi(){
                var content = document.getElementById('textInput').value;
                var newContent = formatText(content);
                document.getElementById('textInput').value = newContent;
                return newContent;
                const options = {
                  method: 'POST',
                  headers: {
                    'Content-Type': 'application/json'
                  },
                  body: JSON.stringify({"content":content})
                };
                fetch('http://127.0.0.1:8000/rewrite', options)
                  .then(response => {
                    if (!response.ok) {
                      throw new Error('Network response was not ok');
                    }
                    return newContent;
                  })
                  .then(data => {
                    console.log('Response data:', data);
                    document.getElementById('textInput').value = data.message;
                  })
                  .catch(error => {
                    console.error('There was a problem with the fetch operation:', error);
                  });
                // fetch('http://127.0.0.1:8000/rewrite')
                //   .then(response => {
                //     if (!response.ok) {
                //       throw new Error('Network response was not ok');
                //     }
                //     // console.log(response.json());
                //   })
                //   .then(data => {
                //     console.log('Data received:', data);
                //     document.getElementById('textInput').value = data;
                //   })
                //   .catch(error => {
                //     console.error('There was a problem with the fetch operation:', error);
                //   });

                console.log("Rewrite")
            }
          </script>
        

            <div id="emailPopup" class="popup">
              <div class="popup-content">
                <span class="close">&times;</span>
                <h4>Compose New Email</h4>
                <form action="/mail/new-email/" method="POST">
                  {% csrf_token %}
                  <input type="text" placeholder="subject" class="form-control" name="subject" required><br>

                  <input type="email" placeholder="to" class="form-control" name="to"><br>
                  <label for="">Select Campaign</label>
                  <select name="campaigns" id="" class="form-control">
                    <option value="0"></option>
                    {% for i in campaigns %}
                    <option value="{{i.id}}">{{i.name}}</option>
                    {% endfor %}
                  </select><br>
                  <textarea name="content" id="textInput" class="form-control txtarea" cols="30" rows="10" placeholder="Content" style="height: 140px;"></textarea><br>
                  <button class="btn btn-secondary" type="button" onclick="rewriteAi()">Rewrite with AI</button>
                  <p id="log"></p>
                  <div style="display: flex;">
                    <div style="display: flex;">
                    <button class="btn btn-primary" onclick="showToast('Email Sent',3000)">Send Mail</button>
                    <div  style="margin-top: 5px;margin-left: 15px;">
                      <span class="material-icons" id="toggleRecording"> micro </span>
                      <button class="btn btn-primary" onclick="window.location.href='/upload'">Upload CSV</button>
                    </div>
                
                  </div>
                   
                  </div>
                </form>
              </div>
            </div>
         
            <script>
              document.getElementById("composeButton").onclick = function() {
                document.getElementById("emailPopup").style.display = "block";
              };

              document.querySelector(".close").onclick = function() {
                document.getElementById("emailPopup").style.display = "none";
              };

              function showToast(message,duration){
                Toastify({
                    text: message,
                    duration: duration,
                    close: true
                }).showToast();
              }


              // Voice capture and processing
              // Check if browser supports the Web Speech API
              if ('SpeechRecognition' in window || 'webkitSpeechRecognition' in window) {
                const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
                let isRecording = false;

                // Set continuous to true to keep listening
                recognition.continuous = true;

                // Handle the recognized result
                recognition.onresult = function(event) {
                    const last = event.results.length - 1;
                    const text = event.results[last][0].transcript;

                    // Log the recognized text to the console
                    console.log('Recognized Text:', text);

                    // Set the recognized text to the input field
                    document.getElementById('textInput').value += text;
                };

                // Toggle recording when the button is clicked
                var log = document.getElementById('log');
                document.getElementById('toggleRecording').addEventListener('click', function() {
                    if (isRecording) {
                        recognition.stop();
                        isRecording = false;
                        console.log('Speech recognition stopped');
                        log.innerText = 'Speech recognition stopped';
                    } else {
                        recognition.start();
                        isRecording = true;
                        console.log('Speech recognition started');
                        log.innerText = 'Speech recognition started';
                    }
                });
            } else {
                // Web Speech API not supported, handle the error
                alert('Your browser does not support Web Speech API');
            }

            


            </script>

      

<script src="index.js"></script>
          
        </div>
        <!-- Email List rows Ends -->
      </div>
      <!-- Email List Ends -->
    </div>
    <!-- Main Body Ends -->
  </body>
</html>